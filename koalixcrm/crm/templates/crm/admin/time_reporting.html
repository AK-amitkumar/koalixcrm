{% extends "admin/base.html" %}
{% block extrahead %}
 <script charset="utf-8" type="text/javascript">
      (function($){
          $(document).ready(function(){
              $("select#id_projects").change(function () {
                  alert("test");
                  $.getJSON("/tasks/project/", {id: $(this).val(), view: 'json'}, function (j) {
                      var options = '<option value="">--------&nbsp;</option>';
                      for (var i = 0; i < j.length; i++) {
                          options += '<option value="' + j[i].id + '">' + j[i].short_description + '</option>';
                      }
                      $("#id_tasks").html(options);
                      $("#id_tasks option:first").attr('selected', 'selected');
                  })
                  $("#id_project").attr('selected', 'selected');
              });
              $('#add_more').click(function() {
                  cloneMore('#oneform:last', 'service');
              });
          });
          function cloneMore(selector, type) {
              var newElement = $(selector).clone(true);
              var total = $('#id_' + type + '-TOTAL_FORMS').val();
              newElement.find(':input').each(function() {
                  var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');
                  var id = 'id_' + name;
                  $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
              });
              newElement.find('label').each(function() {
                  var newFor = $(this).attr('for').replace('-' + (total-1) + '-','-' + total + '-');
                  $(this).attr('for', newFor);
              });
              total++;
              $('#id_' + type + '-TOTAL_FORMS').val(total);
              $(selector).after(newElement);
          }
      })(grp.jQuery);
</script>
{% endblock %}
{% block title %}
Reporting
{% endblock %}

{% block content %}


<form action="" method="post">{% csrf_token %}
    {{ formset.management_form }}
<div>
    <table>
    {% for form in formset %}
    {% if forloop.first %}
    <tr>
        {% for field in form %}
        <th>{{ field.label }}</th>
        {% endfor %}
        <th>Delete</th>
    </tr>
    {% endif %}<tr id='oneform'>
            {% for field in form %}
            <td>{{ field }}</td>
            {% endfor %}
        {% if formset.can_delete %}
            <td>{{ form.DELETE }}</td>
        {% else %}
            <td></td>
        {% endif %}</tr>
    {% endfor %}
    </table>
</div>

<input type="button" value="Add More" id="add_more">
<input type="hidden" name="action" value="work_report" />
<input type="submit" name="cancel" value="cancel" />
<input type="submit" name="register" value="register" />
</form>
{% endblock %}

